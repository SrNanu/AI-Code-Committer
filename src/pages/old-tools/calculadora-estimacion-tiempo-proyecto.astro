---
import Layout from '../../layouts/Layout.astro';

// Metadatos de la página
export const frontmatter = {
  title: 'Calculadora de Estimación de Tiempo de Proyecto',
  description: `Como gestor de proyectos, quiero una herramienta que me permita ingresar tareas y sus duraciones estimadas, para poder visualizar el tiempo total necesario para completar el proyecto.`,
  tags: ['proyectos', 'gestión', 'tiempo', 'productividad']
};
---

<Layout title={frontmatter.title}>
  <a href={import.meta.env.BASE_URL} class="back-link">&larr; Volver a la Fábrica</a>
  
  <div class="tool-container">
    <h1>{frontmatter.title}</h1>
    <p>{frontmatter.description}</p>
    
    <!-- === COMIENZA EL CÓDIGO HTML DE LA HERRAMIENTA === -->
    <div class="calculator-wrapper">
      <div class="form-container">
        <div class="input-group">
          <label for="task-name">Nombre de la Tarea:</label>
          <input type="text" id="task-name" class="input-field" />
        </div>
        <div class="input-group">
          <label for="task-duration">Duración Estimada (horas):</label>
          <input type="number" id="task-duration" class="input-field" />
        </div>
        <button class="btn btn-primary" id="add-task-btn">Agregar Tarea</button>
      </div>
      
      <div class="results-container">
        <h2>Lista de Tareas</h2>
        <ul id="task-list" class="results-list"></ul>
        <div class="summary">
          <h4>Tiempo Total Estimado:</h4>
          <p id="total-time" class="task-text">0 horas</p>
        </div>
      </div>
    </div>
    <!-- === TERMINA EL CÓDIGO HTML DE LA HERRAMIENTA === -->
  </div>
</Layout>

<script>
// === COMIENZA EL CÓDIGO JAVASCRIPT DE LA HERRAMIENTA ===
const addTaskButton = document.getElementById('add-task-btn');
const taskList = document.getElementById('task-list');
const totalTimeText = document.getElementById('total-time');
let totalTime = 0;

addTaskButton.addEventListener('click', function() {
    const taskNameInput = document.getElementById('task-name');
    const taskDurationInput = document.getElementById('task-duration');
    
    const taskName = taskNameInput.value;
    const taskDuration = parseFloat(taskDurationInput.value);
  
    if (taskName && !isNaN(taskDuration) && taskDuration > 0) {
        // Crear nuevo elemento de tarea
        const taskItem = document.createElement('li');
        taskItem.className = 'task-list-item';
        taskItem.innerHTML = `
            <span class="task-text">${taskName} - ${taskDuration} horas</span>
            <div class="task-actions">
              <button class="btn btn-primary btn-sm complete-btn">Completar</button>
              <button class="btn btn-primary btn-sm delete-btn">Eliminar</button>
            </div>
        `;
      
        // Eventos Completar y Eliminar
        taskItem.querySelector('.complete-btn').addEventListener('click', function() {
            taskItem.querySelector('.task-text').style.textDecoration = 'line-through';
        });
      
        taskItem.querySelector('.delete-btn').addEventListener('click', function() {
            totalTime -= taskDuration;
            updateTotalTime();
            taskList.removeChild(taskItem);
        });

        // Añadir la nueva tarea a la lista y actualizar el tiempo total
        taskList.appendChild(taskItem);
        totalTime += taskDuration;
        updateTotalTime();
        
        // Limpiar campos de entrada
        taskNameInput.value = '';
        taskDurationInput.value = '';
    }
});

function updateTotalTime() {
    totalTimeText.textContent = totalTime + ' horas';
}

// === TERMINA EL CÓDIGO JAVASCRIPT DE LA HERRAMIENTA ===
</script>