---
import Layout from '../../layouts/Layout.astro';

// Metadatos de la página
export const frontmatter = {
  title: 'Calculadora de Estimación de Tiempo de Proyecto',
  description: `Como gestor de proyectos, quiero una herramienta que me permita introducir tareas y sus duraciones estimadas, para poder calcular el tiempo total necesario para completar el proyecto.`,
  tags: ['["proyectos"', '"gestión del tiempo"', '"productividad"', '"estimación"]']
};
---

<Layout title={frontmatter.title}>
  <a href={import.meta.env.BASE_URL} class="back-link">&larr; Volver a la Fábrica</a>
  
  <div class="tool-container">
    <h1>{frontmatter.title}</h1>
    <p>{frontmatter.description}</p>
    
    <!-- === COMIENZA EL CÓDIGO HTML DE LA HERRAMIENTA === -->
    <div class="calculator-wrapper">
      <div class="form-container">
        <div class="input-group">
          <label for="taskName">Nombre de la Tarea:</label>
          <input type="text" id="taskName" class="input-field" />
        </div>
        <div class="input-group">
          <label for="taskDuration">Duración Estimada (horas):</label>
          <input type="number" id="taskDuration" class="input-field" />
        </div>
        <button class="btn btn-primary" id="addTaskBtn">Añadir Tarea</button>
        <button class="btn btn-primary" id="calculateTotalBtn">Calcular Total</button>
      </div>
      
      <div class="results-container">
        <h2>Tareas</h2>
        <ul id="task-list" class="results-list"></ul>
        <div class="summary">
          <div class="summary-item">
            <h4>Total de Horas Estimadas:</h4>
            <p id="totalHoras">0</p>
          </div>
        </div>
      </div>
    </div>
    <!-- === TERMINA EL CÓDIGO HTML DE LA HERRAMIENTA === -->
  </div>
</Layout>

<script>
// === COMIENZA EL CÓDIGO JAVASCRIPT DE LA HERRAMIENTA ===
const taskNameInput = document.getElementById('taskName');
const taskDurationInput = document.getElementById('taskDuration');
const taskList = document.getElementById('task-list');
const totalHorasElement = document.getElementById('totalHoras');
const addTaskBtn = document.getElementById('addTaskBtn');
const calculateTotalBtn = document.getElementById('calculateTotalBtn');

let tasks = [];

addTaskBtn.addEventListener('click', () => {
  const taskName = taskNameInput.value.trim();
  const taskDuration = parseFloat(taskDurationInput.value);

  if (taskName && !isNaN(taskDuration) && taskDuration > 0) {
    tasks.push({ name: taskName, duration: taskDuration });

    const listItem = document.createElement('li');
    listItem.className = 'task-list-item';
    listItem.innerHTML = `
      <span class="task-text">${taskName} - ${taskDuration} horas</span>
      <div class="task-actions">
        <button class="btn btn-primary btn-sm complete-btn">Completar</button>
        <button class="btn btn-primary btn-sm delete-btn">Eliminar</button>
      </div>
    `;

    const completeBtn = listItem.querySelector('.complete-btn');
    const deleteBtn = listItem.querySelector('.delete-btn');

    completeBtn.addEventListener('click', () => {
      listItem.classList.toggle('completed');
    });
    
    deleteBtn.addEventListener('click', () => {
      tasks = tasks.filter(task => task.name !== taskName || task.duration !== taskDuration);
      taskList.removeChild(listItem);
      updateTotal();
    });

    taskList.appendChild(listItem);
    updateTotal();

    taskNameInput.value = '';
    taskDurationInput.value = '';
  }
});

calculateTotalBtn.addEventListener('click', updateTotal);

function updateTotal() {
  const totalHours = tasks.reduce((total, task) => total + task.duration, 0);
  totalHorasElement.textContent = totalHours;
}
// === TERMINA EL CÓDIGO JAVASCRIPT DE LA HERRAMIENTA ===
</script>