---
import Layout from '../../layouts/Layout.astro';

// Metadatos de la página
export const frontmatter = {
  title: 'Planificador de Desafíos Semanales',
  description: `Como persona que busca mejorar mis hábitos y habilidades, quiero una herramienta que me permita crear y seguir desafíos semanales personalizados, para mantenerme motivado y medir mi progreso de manera visual.`,
  tags: ['desafíos', 'hábitos', 'productividad', 'seguimiento', 'motivación']
};
---

<Layout title={frontmatter.title}>
  <a href={import.meta.env.BASE_URL} class="back-link">&larr; Volver a la Fábrica</a>
  
  <div class="tool-container">
    <h1>{frontmatter.title}</h1>
    <p>{frontmatter.description}</p>
    
    <!-- === COMIENZA EL CÓDIGO HTML DE LA HERRAMIENTA === -->
    <div class="tool-wrapper">
      <div class="form-container">
        <div class="input-group">
          <label for="challenge-name">Nombre del Desafío:</label>
          <input type="text" id="challenge-name" class="input-field" />
        </div>
        <div class="input-group">
          <label for="challenge-duration">Duración del Desafío (días): <span id="slider-value">1</span></label>
          <input type="range" id="challenge-duration" min="1" max="7" value="1" />
        </div>
        <button id="add-challenge" class="btn btn-primary">Agregar Desafío</button>
      </div>

      <div class="results-container">
        <div id="feedback-alert" class="alert alert-success" role="alert" style="display: none;"></div>
        <h2>Mis Desafíos</h2>
        <ul id="challenge-list" class="results-list"></ul>
      </div>
    </div>
    <!-- === TERMINA EL CÓDIGO HTML DE LA HERRAMIENTA === -->
  </div>
</Layout>

<script>
// === COMIENZA EL CÓDIGO JAVASCRIPT DE LA HERRAMIENTA ===
const addChallengeButton = document.getElementById('add-challenge');
const challengeNameInput = document.getElementById('challenge-name');
const challengeDurationInput = document.getElementById('challenge-duration');
const sliderValueDisplay = document.getElementById('slider-value');
const challengeList = document.getElementById('challenge-list');
const feedbackAlert = document.getElementById('feedback-alert');

// Actualiza el valor del slider
challengeDurationInput.addEventListener('input', (event) => {
  sliderValueDisplay.textContent = event.target.value;
});

// Agrega un desafío a la lista
addChallengeButton.addEventListener('click', () => {
  const challengeName = challengeNameInput.value.trim();
  const challengeDuration = challengeDurationInput.value;

  if (challengeName) {
    // Crear un nuevo elemento de lista
    const listItem = document.createElement('li');
    listItem.className = 'task-list-item';
    listItem.innerHTML = `
      <span class="task-text">${challengeName} (${challengeDuration} día(s))</span>
      <div class="task-actions">
        <button class="btn btn-primary btn-sm complete-btn">Marcar como Completado</button>
        <button class="btn btn-primary btn-sm delete-btn">Eliminar</button>
      </div>
    `;

    // Eventos para botones en la lista
    const completeButton = listItem.querySelector('.complete-btn');
    const deleteButton = listItem.querySelector('.delete-btn');

    completeButton.addEventListener('click', () => {
      feedbackAlert.textContent = '¡Desafío Completado!';
      feedbackAlert.style.display = 'block';
      setTimeout(() => { feedbackAlert.style.display = 'none'; }, 3000);
      listItem.remove(); // Elimina el desafío de la lista
    });

    deleteButton.addEventListener('click', () => {
      listItem.remove(); // Elimina el desafío de la lista
    });

    challengeList.appendChild(listItem);

    // Reinicia el input
    challengeNameInput.value = '';
    challengeDurationInput.value = 1;
    sliderValueDisplay.textContent = '1';
  }
});
// === TERMINA EL CÓDIGO JAVASCRIPT DE LA HERRAMIENTA ===
</script>